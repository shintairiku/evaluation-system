# 要件定義書: Goal Review UI

## 1. 概要
このプロジェクトは、人事評価システムにおいて、管理職（上司）が部下の提出した目標を承認・差し戻しするためのUIページを開発することを目的としています。現在の評価プロセスにおいて、部下が設定した目標に対する上司の承認プロセスが効率化されていないという課題を解決します。

このシステムにより、上司は部下の目標を一覧で確認し、適切なフィードバックと共に承認・差し戻しの判断を効率的に行えるようになります。

## 2. 要件一覧

### 要件1: 目標承認ダッシュボード表示

**実装対象:**
- ページ: `frontend/src/app/(evaluation)/(supervisor)/goal-review/page.tsx`
- メインコンポーネント: `frontend/src/feature/evaluation/superviser/goal-review/display/index.tsx`

**ユーザーストーリー:**
> 上司として、部下が提出した承認待ちの目標を一覧で確認したい。なぜなら、効率的に承認業務を進めたいからだ。

**受入基準:**
```gherkin
WHEN 上司が目標承認ページにアクセスする
THEN ページタイトルが「目標承認」で表示されること
AND 承認待ちの件数がバッジで表示されること
AND 現在の評価期間が表示されること

WHEN 承認待ちの目標が存在する場合
THEN 部下ごとにタブで分類されて表示されること
AND タブには「[名前] ([雇用形態])」の形式で表示されること
AND 各タブに未承認件数のバッジが表示されること

WHEN 承認待ちの目標が存在しない場合
THEN 「承認待ちの目標はありません」のメッセージが表示されること
```

### 要件2: 目標詳細表示

**実装対象:**
- コンポーネント: `frontend/src/feature/evaluation/superviser/goal-review/components/GoalApprovalCard/`
- コンポーネント: `frontend/src/feature/evaluation/superviser/goal-review/components/EmployeeInfoHeader/`

**ユーザーストーリー:**
> 上司として、部下の目標の詳細内容を確認したい。なぜなら、適切な判断を行うために全ての情報が必要だからだ。

**受入基準:**
```gherkin
WHEN 特定の部下のタブを選択する
THEN その部下の基本情報（アバター、名前、社員ID、雇用形態）が表示されること
AND その部下の目標がカード形式で一覧表示されること

WHEN 目標カードが表示される
THEN カテゴリアイコンと名前が表示されること
AND ウェイト（重み）が表示されること
AND 提出日が表示されること
AND 承認待ちのバッジが表示されること
AND 目標タイトルと詳細内容がグレーボックス内に表示されること

WHEN 業績目標の場合
THEN 目標タイトル、具体的な目標内容、達成基準、方法が表示されること

WHEN コンピテンシー目標の場合
THEN コンピテンシー名、行動計画が表示されること
```

### 要件3: 目標承認機能

**実装対象:**
- コンポーネント: `frontend/src/feature/evaluation/superviser/goal-review/components/ApprovalForm/`
- コンポーネント: `frontend/src/feature/evaluation/superviser/goal-review/components/ActionButtons/`

**ユーザーストーリー:**
> 上司として、部下の目標を承認または差し戻しをしたい。なぜなら、部下の成長を支援し、適切な目標設定を促したいからだ。

**受入基準:**
```gherkin
WHEN 目標カード上でコメント入力フィールドに入力する
THEN テキストが正しく入力されること
AND 文字数制限内で入力が制限されること

WHEN 「承認」ボタンをクリックする
THEN 確認ダイアログが表示されること
AND コメントが任意であることが示されること

WHEN 「差し戻し」ボタンをクリックする
THEN 確認ダイアログが表示されること
AND コメントが必須であることが示されること

WHEN 差し戻しでコメントが空の場合
THEN エラーメッセージ「差し戻し時はコメントの入力が必要です」が表示されること
AND 送信が阻止されること

WHEN 承認または差し戻しが完了する
THEN 成功メッセージが表示されること
AND 該当の目標カードがリストから削除されること
AND 承認待ち件数のバッジが更新されること
```

### 要件4: 承認ガイドライン表示

**実装対象:**
- コンポーネント: `frontend/src/feature/evaluation/superviser/goal-review/components/GuidelinesAlert/`
- コンポーネント: `frontend/src/feature/evaluation/superviser/goal-review/components/ApprovalGuidelinesPanel/`

**ユーザーストーリー:**
> 上司として、目標承認の基準を確認したい。なぜなら、一貫性のある適切な判断を行いたいからだ。

**受入基準:**
```gherkin
WHEN ページが表示される
THEN 目標承認ガイドラインがアラートボックスで表示されること
AND ガイドラインには承認基準の説明が含まれること

WHEN ページ下部を確認する
THEN 詳細な承認ガイドラインセクションが表示されること
AND 承認すべき基準が明記されること
AND 差し戻しすべき基準が明記されること
AND フィードバックのベストプラクティスが表示されること
```

### 要件5: レスポンシブデザイン

**実装対象:**
- 共有コンポーネント: `frontend/src/components/ui/` (既存のshadcn/uiコンポーネントを活用)
- レスポンシブレイアウト: 全goal-review関連コンポーネント

**ユーザーストーリー:**
> 上司として、モバイルデバイスでも目標承認を行いたい。なぜなら、外出先でも迅速に対応したいからだ。

**受入基準:**
```gherkin
WHEN モバイルデバイス（画面幅768px以下）でアクセスする
THEN タブがモバイル向けのレイアウトで表示されること
AND ボタンのタップ領域が最低44px以上であること
AND テキストが読みやすいサイズで表示されること

WHEN タブレットデバイス（画面幅1024px以下）でアクセスする
THEN デスクトップ版と同等の機能が利用できること
AND レイアウトが適切に調整されること
```

### 要件6: パフォーマンス要件

**要求事項:**
ページの読み込みと操作のレスポンス性を確保し、ユーザーがストレスなく承認業務を行えるようにする。

**受入基準:**
```gherkin
GIVEN 承認待ち目標が100件以下の状態で
WHEN ページを初回読み込みする
THEN 2秒以内にすべてのコンテンツが表示されること

GIVEN 承認または差し戻しアクションを実行した状態で
WHEN API呼び出しが完了する
THEN 1秒以内にUIが更新されること

GIVEN 承認待ち目標が100件を超える状態で
WHEN ページを読み込みする
THEN ページネーションが実装されること
AND 1ページあたり最大20件まで表示されること
```

### 要件7: アクセシビリティ要件

**要求事項:**
すべてのユーザーが目標承認機能を利用できるよう、アクセシビリティ基準を満たす。

**受入基準:**
```gherkin
GIVEN スクリーンリーダーを使用している状態で
WHEN ページを操作する
THEN すべての重要な情報が音声で読み上げられること
AND ボタンの目的が明確に伝わること

GIVEN キーボードのみで操作している状態で
WHEN Tabキーでナビゲーションする
THEN すべてのインタラクティブ要素にアクセスできること
AND フォーカスインジケーターが明確に表示されること

GIVEN ハイコントラストモードを使用している状態で
THEN すべてのテキストと背景のコントラスト比が4.5:1以上であること
AND 重要な情報が色以外でも識別できること
```